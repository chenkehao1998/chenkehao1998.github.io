(window.webpackJsonp=window.webpackJsonp||[]).push([[225],{892:function(e,s,a){"use strict";a.r(s);var l=a(3),n=Object(l.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("centos7版本对防火墙进行加强,不再使用原来的iptables,启用firewalld")]),e._v(" "),s("h1",{attrs:{id:"简单上手-以配置8080端口为例"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#简单上手-以配置8080端口为例"}},[e._v("#")]),e._v(" 简单上手（以配置8080端口为例）")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("输入命令查看防火墙的状态")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("firewall-cmd --state;\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("如果没有开启，输入命令")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("systemctl start firewalld.service;\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("开启8080端口，输入：")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("firewall-cmd --zone=public --add-port=8080/tcp --permanent;\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("ul",[s("li",[e._v("zone=public：表示作用域为公共的；")]),e._v(" "),s("li",[e._v("add-port=8080/tcp：添加tcp协议的端口8080；")]),e._v(" "),s("li",[e._v("permanent：永久生效，如果没有此参数，则只能维持当前服务生命周期内，重新启动后失效；")])])]),e._v(" "),s("li",[s("p",[e._v("输入命令重启防火墙")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("systemctl restart firewalld.service;\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("输入命令重新载入配置")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("firewall-cmd --reload; \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])])]),e._v(" "),s("h1",{attrs:{id:"firewall相关命令介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#firewall相关命令介绍"}},[e._v("#")]),e._v(" firewall相关命令介绍")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("firewalld的基本使用")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("启动：  systemctl start firewalld\n查状态：systemctl status firewalld \n停止：  systemctl disable firewalld\n禁用：  systemctl stop firewalld\n在开机时启用一个服务：systemctl enable firewalld.service\n在开机时禁用一个服务：systemctl disable firewalld.service\n查看服务是否开机启动：systemctl is-enabled firewalld.service\n查看已启动的服务列表：systemctl list-unit-files|grep enabled\n查看启动失败的服务列表：systemctl --failed\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("配置firewalld-cmd")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("查看版本： firewall-cmd --version\n查看帮助： firewall-cmd --help\n显示状态： firewall-cmd --state\n查看所有打开的端口： firewall-cmd --zone=public --list-ports\n更新防火墙规则： firewall-cmd --reload\n查看区域信息:  firewall-cmd --get-active-zones\n查看指定接口所属区域： firewall-cmd --get-zone-of-interface=eth0\n拒绝所有包：firewall-cmd --panic-on\n取消拒绝状态： firewall-cmd --panic-off\n查看是否拒绝： firewall-cmd --query-panic\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br")])])]),e._v(" "),s("li",[s("p",[e._v("那怎么开启一个端口呢")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("添加\nfirewall-cmd --zone=public(作用域) --add-port=80/tcp(端口和访问类型) --permanent(永久生效)\nfirewall-cmd --zone=public --add-service=http --permanent\nfirewall-cmd --reload    # 重新载入，更新防火墙规则\nfirewall-cmd --zone= public --query-port=80/tcp  #查看\nfirewall-cmd --zone= public --remove-port=80/tcp --permanent  # 删除\n\nfirewall-cmd --list-services\nfirewall-cmd --get-services\nfirewall-cmd --add-service=<service>\nfirewall-cmd --delete-service=<service>\n在每次修改端口和服务后/etc/firewalld/zones/public.xml文件就会被修改,所以也可以在文件中之间修改,然后重新加载\n使用命令实际也是在修改文件，需要重新加载才能生效。\n\nfirewall-cmd --zone=public --query-port=80/tcp\nfirewall-cmd --zone=public --query-port=8080/tcp\nfirewall-cmd --zone=public --query-port=3306/tcp\nfirewall-cmd --zone=public --add-port=8080/tcp --permanent\nfirewall-cmd --zone=public --add-port=3306/tcp --permanent\nfirewall-cmd --zone=public --query-port=3306/tcp\nfirewall-cmd --zone=public --query-port=8080/tcp\nfirewall-cmd --reload  # 重新加载后才能生效\nfirewall-cmd --zone=public --query-port=3306/tcp\nfirewall-cmd --zone=public --query-port=8080/tcp\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br"),s("span",{staticClass:"line-number"},[e._v("16")]),s("br"),s("span",{staticClass:"line-number"},[e._v("17")]),s("br"),s("span",{staticClass:"line-number"},[e._v("18")]),s("br"),s("span",{staticClass:"line-number"},[e._v("19")]),s("br"),s("span",{staticClass:"line-number"},[e._v("20")]),s("br"),s("span",{staticClass:"line-number"},[e._v("21")]),s("br"),s("span",{staticClass:"line-number"},[e._v("22")]),s("br"),s("span",{staticClass:"line-number"},[e._v("23")]),s("br"),s("span",{staticClass:"line-number"},[e._v("24")]),s("br")])]),s("p",[e._v("4.参数解释")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("–add-service #添加的服务\n–zone #作用域\n–add-port=80/tcp #添加端口，格式为：端口/通讯协议\n–permanent #永久生效，没有此参数重启后失效\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br")])]),s("p",[e._v("5.详细使用")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('firewall-cmd --permanent --zone=public --add-rich-rule=\'rule family="ipv4" source address="192.168.0.4/24" service name="http" accept\'    //设置某个ip访问某个服务\nfirewall-cmd --permanent --zone=public --remove-rich-rule=\'rule family="ipv4" source address="192.168.0.4/24" service name="http" accept\' //删除配置\nfirewall-cmd --permanent --add-rich-rule \'rule family=ipv4 source address=192.168.0.1/2 port port=80 protocol=tcp accept\'     //设置某个ip访问某个端口\nfirewall-cmd --permanent --remove-rich-rule \'rule family=ipv4 source address=192.168.0.1/2 port port=80 protocol=tcp accept\'     //删除配置\n\nfirewall-cmd --query-masquerade  # 检查是否允许伪装IP\nfirewall-cmd --add-masquerade    # 允许防火墙伪装IP\nfirewall-cmd --remove-masquerade # 禁止防火墙伪装IP\n\nfirewall-cmd --add-forward-port=port=80:proto=tcp:toport=8080   # 将80端口的流量转发至8080\nfirewall-cmd --add-forward-port=proto=80:proto=tcp:toaddr=192.168.1.0.1 # 将80端口的流量转发至192.168.0.1\nfirewall-cmd --add-forward-port=proto=80:proto=tcp:toaddr=192.168.0.1:toport=8080 # 将80端口的流量转发至192.168.0.1的8080端口\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br")])])])]),e._v(" "),s("h1",{attrs:{id:"centos7以下版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#centos7以下版本"}},[e._v("#")]),e._v(" centos7以下版本")]),e._v(" "),s("ol",[s("li",[e._v("开放80，22，8080 端口"),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("/sbin/iptables -I INPUT -p tcp --dport 80 -j ACCEPT\n/sbin/iptables -I INPUT -p tcp --dport 22 -j ACCEPT\n/sbin/iptables -I INPUT -p tcp --dport 8080 -j ACCEPT\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])])]),e._v(" "),s("li",[e._v("保存"),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("/etc/rc.d/init.d/iptables save\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])]),e._v(" "),s("li",[e._v("查看打开的端口"),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("/etc/init.d/iptables status\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])])]),e._v(" "),s("li",[e._v("关闭防火墙\n1） 永久性生效，重启后不会复原\n开启： chkconfig iptables on\n关闭： chkconfig iptables off\n2） 即时生效，重启后复原\n开启： service iptables start\n关闭： service iptables stop")])])])}),[],!1,null,null,null);s.default=n.exports}}]);