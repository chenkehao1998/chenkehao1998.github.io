(window.webpackJsonp=window.webpackJsonp||[]).push([[213],{869:function(r,e,t){"use strict";t.r(e);var _=t(3),v=Object(_.a)({},(function(){var r=this,e=r._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":r.$parent.slotKey}},[e("h1",{attrs:{id:"_1-docker容器的重启策略"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-docker容器的重启策略"}},[r._v("#")]),r._v(" 1. Docker容器的重启策略")]),r._v(" "),e("p",[r._v("Docker容器的重启策略是面向生产环境的一个启动策略，在开发过程中可以忽略该策略。")]),r._v(" "),e("p",[r._v("Docker容器的重启都是由Docker守护进程完成的，因此与守护进程息息相关。")]),r._v(" "),e("p",[r._v("Docker容器的重启策略如下：")]),r._v(" "),e("ul",[e("li",[r._v("no，默认策略，在容器退出时不重启容器")]),r._v(" "),e("li",[r._v("on-failure，在容器非正常退出时（退出状态非0），才会重启容器")]),r._v(" "),e("li",[r._v("on-failure:3，在容器非正常退出时重启容器，最多重启3次")]),r._v(" "),e("li",[r._v("always，在容器退出时总是重启容器")]),r._v(" "),e("li",[r._v("unless-stopped，在容器退出时总是重启容器，但是不考虑在Docker守护进程启动时就已经停止了的容器")])]),r._v(" "),e("h1",{attrs:{id:"_2-docker容器的退出状态码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-docker容器的退出状态码"}},[r._v("#")]),r._v(" 2. Docker容器的退出状态码")]),r._v(" "),e("p",[r._v("docker run的退出状态码如下：")]),r._v(" "),e("ul",[e("li",[r._v("0，表示正常退出")]),r._v(" "),e("li",[r._v("非0，表示异常退出（退出状态码采用chroot标准）")]),r._v(" "),e("li",[r._v("125，Docker守护进程本身的错误")]),r._v(" "),e("li",[r._v("126，容器启动后，要执行的默认命令无法调用")]),r._v(" "),e("li",[r._v("127，容器启动后，要执行的默认命令不存在")]),r._v(" "),e("li",[r._v("其他命令状态码，容器启动后正常执行命令，退出命令时该命令的返回状态码作为容器的退出状态码")])]),r._v(" "),e("h1",{attrs:{id:"_3-docker-run的-restart选项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-docker-run的-restart选项"}},[r._v("#")]),r._v(" 3. docker run的--restart选项")]),r._v(" "),e("p",[r._v("通过--restart选项，可以设置容器的重启策略，以决定在容器退出时Docker守护进程是否重启刚刚退出的容器。")]),r._v(" "),e("p",[r._v("--restart选项通常只用于detached模式的容器。")]),r._v(" "),e("p",[r._v("--restart选项不能与--rm选项同时使用。显然，--restart选项适用于detached模式的容器，而--rm选项适用于foreground模式的容器。")]),r._v(" "),e("p",[r._v("在docker ps查看容器时，对于使用了--restart选项的容器，其可能的状态只有Up或Restarting两种状态。")]),r._v(" "),e("p",[r._v("示例：\ndocker run -d --restart=always ba-208\ndocker run -d --restart=on-failure:10 ba-208")]),r._v(" "),e("p",[r._v("补充：")]),r._v(" "),e("p",[r._v('查看容器重启次数\ndocker inspect -f "{undefined{ .RestartCount }}" ba-208\n查看容器最后一次的启动时间\ndocker inspect -f "{undefined{ .State.StartedAt }}" ba-208')]),r._v(" "),e("p",[r._v("参考链接：")]),r._v(" "),e("p",[r._v("https://docs.docker.com/engine/reference/run/")])])}),[],!1,null,null,null);e.default=v.exports}}]);