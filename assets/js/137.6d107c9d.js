(window.webpackJsonp=window.webpackJsonp||[]).push([[137],{758:function(n,s,a){"use strict";a.r(s);var e=a(3),t=Object(e.a)({},(function(){var n=this,s=n._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[s("blockquote",[s("p",[n._v("我们知道hashMap是非"),s("a",{attrs:{href:"https://so.csdn.net/so/search?q=%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8&spm=1001.2101.3001.7020",target:"_blank",rel:"noopener noreferrer"}},[n._v("线程安全"),s("OutboundLink")],1),n._v("的，为了实现线程安全，无非就是以下三种方式：\n"),s("code",[n._v("Hashtable 、ConcurrentHashMap 、SynchronizedMap")]),n._v("\n这篇文章主要讲解"),s("code",[n._v("SynchronizedMap")]),n._v("是怎么实现线程安全的")])]),n._v(" "),s("p",[s("strong",[n._v("SynchronizedMap用法：")])]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v(' HashMap hashMap = new HashMap<String, String>();\n     hashMap.put("one", "1");\n     hashMap.put("two", "2");\n     Map<String, String> map =  Collections.synchronizedMap(hashMap);\n     Log.e("iterator", map.get("one"));\n     Log.e("iterator", map.get("two"));\n')])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br")])]),s("blockquote",[s("p",[s("code",[n._v("Collections.synchronizedMap(hashMap)")]),n._v("用来创建"),s("code",[n._v("SynchronizedMap")]),n._v("对象")])]),n._v(" "),s("p",[s("strong",[n._v("SynchronizedMap源码：")])]),n._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[n._v("// synchronizedMap方法\npublic static <K,V> Map<K,V> synchronizedMap(Map<K,V> m) {\n       return new SynchronizedMap<>(m);\n   }\n// SynchronizedMap类\nprivate static class SynchronizedMap<K,V>\n       implements Map<K,V>, Serializable {\n       private static final long serialVersionUID = 1978198479659022715L;\n\n       private final Map<K,V> m;     // Backing Map\n       final Object      mutex;        // Object on which to synchronize\n\n       SynchronizedMap(Map<K,V> m) {\n           this.m = Objects.requireNonNull(m);\n           mutex = this;\n       }\n\n       SynchronizedMap(Map<K,V> m, Object mutex) {\n           this.m = m;\n           this.mutex = mutex;\n       }\n\n       public int size() {\n           synchronized (mutex) {return m.size();}\n       }\n       public boolean isEmpty() {\n           synchronized (mutex) {return m.isEmpty();}\n       }\n       public boolean containsKey(Object key) {\n           synchronized (mutex) {return m.containsKey(key);}\n       }\n       public boolean containsValue(Object value) {\n           synchronized (mutex) {return m.containsValue(value);}\n       }\n       public V get(Object key) {\n           synchronized (mutex) {return m.get(key);}\n       }\n\n       public V put(K key, V value) {\n           synchronized (mutex) {return m.put(key, value);}\n       }\n       public V remove(Object key) {\n           synchronized (mutex) {return m.remove(key);}\n       }\n       // 省略其他方法\n} \n")])]),n._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[n._v("1")]),s("br"),s("span",{staticClass:"line-number"},[n._v("2")]),s("br"),s("span",{staticClass:"line-number"},[n._v("3")]),s("br"),s("span",{staticClass:"line-number"},[n._v("4")]),s("br"),s("span",{staticClass:"line-number"},[n._v("5")]),s("br"),s("span",{staticClass:"line-number"},[n._v("6")]),s("br"),s("span",{staticClass:"line-number"},[n._v("7")]),s("br"),s("span",{staticClass:"line-number"},[n._v("8")]),s("br"),s("span",{staticClass:"line-number"},[n._v("9")]),s("br"),s("span",{staticClass:"line-number"},[n._v("10")]),s("br"),s("span",{staticClass:"line-number"},[n._v("11")]),s("br"),s("span",{staticClass:"line-number"},[n._v("12")]),s("br"),s("span",{staticClass:"line-number"},[n._v("13")]),s("br"),s("span",{staticClass:"line-number"},[n._v("14")]),s("br"),s("span",{staticClass:"line-number"},[n._v("15")]),s("br"),s("span",{staticClass:"line-number"},[n._v("16")]),s("br"),s("span",{staticClass:"line-number"},[n._v("17")]),s("br"),s("span",{staticClass:"line-number"},[n._v("18")]),s("br"),s("span",{staticClass:"line-number"},[n._v("19")]),s("br"),s("span",{staticClass:"line-number"},[n._v("20")]),s("br"),s("span",{staticClass:"line-number"},[n._v("21")]),s("br"),s("span",{staticClass:"line-number"},[n._v("22")]),s("br"),s("span",{staticClass:"line-number"},[n._v("23")]),s("br"),s("span",{staticClass:"line-number"},[n._v("24")]),s("br"),s("span",{staticClass:"line-number"},[n._v("25")]),s("br"),s("span",{staticClass:"line-number"},[n._v("26")]),s("br"),s("span",{staticClass:"line-number"},[n._v("27")]),s("br"),s("span",{staticClass:"line-number"},[n._v("28")]),s("br"),s("span",{staticClass:"line-number"},[n._v("29")]),s("br"),s("span",{staticClass:"line-number"},[n._v("30")]),s("br"),s("span",{staticClass:"line-number"},[n._v("31")]),s("br"),s("span",{staticClass:"line-number"},[n._v("32")]),s("br"),s("span",{staticClass:"line-number"},[n._v("33")]),s("br"),s("span",{staticClass:"line-number"},[n._v("34")]),s("br"),s("span",{staticClass:"line-number"},[n._v("35")]),s("br"),s("span",{staticClass:"line-number"},[n._v("36")]),s("br"),s("span",{staticClass:"line-number"},[n._v("37")]),s("br"),s("span",{staticClass:"line-number"},[n._v("38")]),s("br"),s("span",{staticClass:"line-number"},[n._v("39")]),s("br"),s("span",{staticClass:"line-number"},[n._v("40")]),s("br"),s("span",{staticClass:"line-number"},[n._v("41")]),s("br"),s("span",{staticClass:"line-number"},[n._v("42")]),s("br"),s("span",{staticClass:"line-number"},[n._v("43")]),s("br"),s("span",{staticClass:"line-number"},[n._v("44")]),s("br"),s("span",{staticClass:"line-number"},[n._v("45")]),s("br"),s("span",{staticClass:"line-number"},[n._v("46")]),s("br")])]),s("blockquote",[s("p",[n._v("可以看到"),s("code",[n._v("synchronizedMap")]),n._v("内部所有的方法其实都是执行我们传入的"),s("code",[n._v("map")]),n._v("对象的方法，只不过都用"),s("code",[n._v("synchronized")]),n._v(" 进行上锁。这里就是使用到了"),s("code",[n._v("java")]),n._v("的代理模式。")])])])}),[],!1,null,null,null);s.default=t.exports}}]);