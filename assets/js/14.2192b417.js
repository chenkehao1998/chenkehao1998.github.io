(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{532:function(t,a,_){t.exports=_.p+"assets/img/watermark_type_ZmFuZ3poZW5naGVpd_8a393298a4f64a21b.65a9db6a.png"},533:function(t,a,_){t.exports=_.p+"assets/img/watermark_type_ZmFuZ3poZW5naGVpd_75e0fa81f12b40d2b.6328ed83.png"},534:function(t,a,_){t.exports=_.p+"assets/img/watermark_type_ZmFuZ3poZW5naGVpd_10a84fe55ca4498d9.54890925.png"},535:function(t,a,_){t.exports=_.p+"assets/img/watermark_type_ZmFuZ3poZW5naGVpd_fdd2f9900e9d4ed58.84d51da1.png"},536:function(t,a,_){t.exports=_.p+"assets/img/watermark_type_ZmFuZ3poZW5naGVpd_1322936f77e34db3a.4b40b781.png"},537:function(t,a,_){t.exports=_.p+"assets/img/watermark_type_ZmFuZ3poZW5naGVpd_e771e5306c9841f98.e8671a69.png"},538:function(t,a,_){t.exports=_.p+"assets/img/watermark_type_ZmFuZ3poZW5naGVpd_d98fef6ee81e4179a.ea07f806.png"},539:function(t,a,_){t.exports=_.p+"assets/img/watermark_type_ZmFuZ3poZW5naGVpd_3c016f4cee2848bb9.d4917fae.png"},863:function(t,a,_){"use strict";_.r(a);var s=_(3),e=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"起因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#起因"}},[t._v("#")]),t._v(" 起因")]),t._v(" "),a("p",[t._v("在改完host文件配置之后, 经过了mysql, docker, redis, jdk, nginx等各种安装配置之后, nginx代理80端口, 浏览器访问"),a("code",[t._v("sinjar.cn")]),t._v("也成功打开页面. 但是第二天再次访问的时候, 发现居然提示我域名要备案.")]),t._v(" "),a("p",[a("img",{attrs:{src:_(532),alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("我擦嘞, 我本地的host文件里的域名备什么案! 只是做本地ip解析用的!")]),t._v(" "),a("h1",{attrs:{id:"查找原因"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查找原因"}},[t._v("#")]),t._v(" 查找原因")]),t._v(" "),a("p",[t._v("在网上查找了原因之后, 发现是访问阿里云服务器的时候, 阿里云服务器的网关会对非授权的访问进行截获。")]),t._v(" "),a("p",[t._v("如果你没有备案，那么"),a("strong",[t._v("针对特定端口，比如80，443")]),t._v("的请求进行截获。当你备案后就予以放行。")]),t._v(" "),a("p",[a("img",{attrs:{src:_(533),alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("也就是说, 如果没有备案的话, 使用本地域名访问80，443端口的话是会被拦截的, 但是访问其它端口却问题(例如使用域名访问22, 3306, 6379等端口就可以正常访问), 而且"),a("strong",[t._v("如果使用ip地址的话, 也是可以正常访问的")]),t._v(".")]),t._v(" "),a("p",[a("img",{attrs:{src:_(534),alt:"在这里插入图片描述"}})]),t._v(" "),a("h1",{attrs:{id:"明明是通过本地host文件解析域名为ip地址-为神马服务器还是知道我访问的域名呢"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#明明是通过本地host文件解析域名为ip地址-为神马服务器还是知道我访问的域名呢"}},[t._v("#")]),t._v(" 明明是通过本地host文件解析域名为ip地址, 为神马服务器还是知道我访问的域名呢")]),t._v(" "),a("p",[t._v("其实从第一开始我输入本地域名, 跳出提示需要备案页面的时候, 我就有这个问题, 我一直以为的是, "),a("em",[t._v("本地host文件里面有对应域名的话, 访问的IP地址会被替换成host文件里面对应的ip地址, 而服务器是获取不了你访问的域名的")]),t._v(".")]),t._v(" "),a("p",[t._v("但事实是, 访问80端口, 通过域名访问, 网关获取了你的域名, 并查出你的域名没有备案, 那么说明请求报文肯定带上了 "),a("code",[t._v("sinjar.cn")]),t._v(" 这个域名.")]),t._v(" "),a("p",[t._v("那么就用Wireshark抓包分析一下(在我电脑里面吃土一年的Wireshark终于再次有了用武之地).")]),t._v(" "),a("p",[t._v("使用IP地址访问, 抓到的请求数据如下.")]),t._v(" "),a("p",[a("img",{attrs:{src:_(535),alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("使用"),a("code",[t._v("sinjar.cn")]),t._v("访问, 抓到的请求数据如下.")]),t._v(" "),a("p",[a("img",{attrs:{src:_(536),alt:"在这里插入图片描述"}})]),t._v(" "),a("p",[t._v("经过抓包测试后才发现, 使用浏览器通过域名访问服务器, 域名确实通过host文件被替换成了ip地址, 但是请求报文的头也还带有你的本地域名(请求头的Host属性).")]),t._v(" "),a("p",[t._v("想来阿里云服务器就是通过"),a("code",[t._v("Hypertext Transder Protocol")]),t._v("中的"),a("code",[t._v("Host")]),t._v("来判断出你使用的这个域名没有经过备案.")]),t._v(" "),a("h1",{attrs:{id:"最终解决方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最终解决方式"}},[t._v("#")]),t._v(" 最终解决方式")]),t._v(" "),a("p",[a("strong",[t._v("插件名： "),a("code",[t._v("ModHeader")])])]),t._v(" "),a("p",[t._v("既然是请求头携带了域名, 那就容易了, 要知道请求头是由浏览器进行封装的, 而万能强大的chrome浏览器修改个host简直太容易了有没有.")]),t._v(" "),a("p",[a("code",[t._v("ModHeader")]),t._v(", 号称能够修改请求和相应的各种数据")]),t._v(" "),a("p",[t._v("我马上安装了这个插件, 并根据操作很快找到了两种解决方式")]),t._v(" "),a("h2",{attrs:{id:"两种配置方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#两种配置方法"}},[t._v("#")]),t._v(" 两种配置方法")]),t._v(" "),a("p",[t._v("第一种配置")]),t._v(" "),a("blockquote",[a("p",[t._v("使用"),a("code",[t._v("redirect URLs")]),t._v("功能映射地址, 这样的话, 当你输入域名的时候, 浏览器会自动将域名转换为IP地址, 但是这样的话浏览器URL栏里面的"),a("code",[t._v("sinjar.cn")]),t._v(", 会变成ip "),a("code",[t._v("118.xxx.xx.xxx")]),t._v(", 感觉用着也不太优雅."),a("img",{attrs:{src:_(537),alt:"在这里插入图片描述"}})])]),t._v(" "),a("p",[t._v("第二种配置(我当前在使用的配置)")]),t._v(" "),a("blockquote",[a("p",[t._v("当浏览器访问域名 "),a("code",[t._v("sinjar.cn")]),t._v(" 的时候, 浏览器会自动把报文头里面的 Host 属性改为"),a("code",[t._v("ip")]),t._v("地址, 这样的话浏览器Url栏里面显示的依然是"),a("code",[t._v("sinjar.cn")]),t._v(". "),a("img",{attrs:{src:_(538),alt:""}}),t._v("\n此时使用 Wireshark 抓包发现Host属性的值也变成了ip地址, 完美解决了我的需求"),a("img",{attrs:{src:_(539),alt:"在这里插入图片描述"}})])])])}),[],!1,null,null,null);a.default=e.exports}}]);