(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{668:function(e,a,n){e.exports=n.p+"assets/img/304f14e12d7147999b63cef8040b6cbd.d9994c36.png"},669:function(e,a,n){e.exports=n.p+"assets/img/b62f2eb6c3bd990b5f6c210fd01e91a5.91099094.png"},670:function(e,a,n){e.exports=n.p+"assets/img/aeea29905a56679647b4db102a033639.10d439d3.png"},671:function(e,a,n){e.exports=n.p+"assets/img/da9bb8d37f233830e6d8d11aee18b7ba.6da21966.png"},974:function(e,a,n){"use strict";n.r(a);var s=n(3),t=Object(s.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("p",[e._v("mysql默认的主从架构不能解决高可用的问题，他在主节点发生错误的时候，不能够自动切换，需要运维人员来处理")]),e._v(" "),a("p",[e._v("MHA是最成熟MySQL高可用方案,采用Perl语言开发")]),e._v(" "),a("p",[a("img",{attrs:{src:n(668),alt:"304f14e12d7147999b63cef8040b6cbd.png"}})]),e._v(" "),a("ul",[a("li",[a("p",[e._v("vip\n虚拟ip")])]),e._v(" "),a("li",[a("p",[e._v("MHA manager\n主要是用于管理节点")])]),e._v(" "),a("li",[a("p",[e._v("MHA node\n接收MHA manager的命令，自动化执行一些任务 故障转移备份迁移等")])]),e._v(" "),a("li",[a("p",[e._v("binlog server\n同步主服务的binlog")])])]),e._v(" "),a("p",[a("img",{attrs:{src:n(669),alt:"b62f2eb6c3bd990b5f6c210fd01e91a5.png"}})]),e._v(" "),a("p",[e._v("MHA manager会默认每3秒向master发送"),a("code",[e._v("select 1")]),e._v("，来检测是否连接成功\n如果三次不成功，则会找slave节点去用ssh访问 ，如果所有的从节点都访问不上就会认为 master已经挂掉了")]),e._v(" "),a("p",[a("img",{attrs:{src:n(670),alt:"aeea29905a56679647b4db102a033639.png"}}),e._v("\n切断slave节点和master节点的同步，然后断开VIP和master的绑定\n然后manager读取binlog server的数据\nmanager找出最新的relay log的MHA node，然后让这个MHA同步数据给所有的slave\n然后manager再将这些slave缺失的数据发给slave\n然后manager挑选出一个新的master\n"),a("img",{attrs:{src:n(671),alt:"da9bb8d37f233830e6d8d11aee18b7ba.png"}}),e._v("\nold master恢复后，可以作为slave自动从new master同步")]),e._v(" "),a("p",[e._v("优点:")]),e._v(" "),a("ul",[a("li",[e._v("由per语言开发的开源工具可以支持基于GTID的复制模式")]),e._v(" "),a("li",[e._v("当主DB不可用时，从多个从服务器中选举出来新的主DB\n= 提供了主从切换和故障转移功能，在线故障转移时不易丢失数据同一个监控节点可以监控多个集群\n缺点:")]),e._v(" "),a("li",[e._v("需要编写脚本或利用第三方工具来实现VIP的配置")]),e._v(" "),a("li",[e._v("MHA启动后只只监控主服务器是否可用，没办法监控从服务器需要")]),e._v(" "),a("li",[e._v("基于SSH免认证登陆配置，存在一定的安全隐患")]),e._v(" "),a("li",[e._v("没有提供从服务器的读负载均衡功能")])])])}),[],!1,null,null,null);a.default=t.exports}}]);